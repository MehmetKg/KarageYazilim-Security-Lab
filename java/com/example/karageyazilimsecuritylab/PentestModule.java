package com.example.karageyazilimsecuritylab;

public class PentestModule {
    public static void runNikto(String url, RequestManager.Callback callback) {
        callback.onResult("[*] Nikto Benzeri Tarama...");
        String[] vulns = {".git/config", "backup.sql", "phpinfo.php", ".env"};
        for(String v : vulns) {
            RequestManager.submit(() -> {
                if(RequestManager.makeHttpRequest(url + "/" + v).startsWith("CODE:200"))
                    callback.onResult("<font color='#FF0000'>[!!!] KRİTİK DOSYA: " + v + "</font>");
            });
        }
    }

    public static void runWfuzz(String url, RequestManager.Callback callback) {
        callback.onResult("[*] Fuzzing Başladı...");
        String[] payloads = {"'", "\"", "<script>"};
        for(String p : payloads) {
            RequestManager.submit(() -> {
                String res = RequestManager.makeHttpRequest(url + p);
                if(!res.startsWith("ERROR")) callback.onResult("Payload denendi: " + p);
            });
        }
    }
}