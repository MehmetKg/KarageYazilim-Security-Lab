package com.example.karageyazilimsecuritylab;

public class ExploitModule {
    public static void runSqlMap(String url, RequestManager.Callback callback) {
        callback.onResult("[*] SQL Injection Testi...");
        RequestManager.submit(() -> {
            long start = System.currentTimeMillis();
            RequestManager.makeHttpRequest(url + "' AND SLEEP(5)--");
            if(System.currentTimeMillis() - start > 4500)
                callback.onResult("<font color='#FF0000'>[!!!] SQL ENJEKSİYON TESPİT EDİLDİ!</font>");
            else callback.onResult("[-] SQLi bulunamadı.");
        });
    }

    public static void runXSStrike(String url, RequestManager.Callback callback) {
        callback.onResult("[*] XSS Testi...");
        RequestManager.submit(() -> {
            String payload = "<Baykus>";
            String res = RequestManager.makeHttpRequest(url + payload);
            if(res.contains(payload)) callback.onResult("<font color='#FF0000'>[!!!] XSS AÇIĞI VAR!</font>");
            else callback.onResult("[-] XSS yok.");
        });
    }

    public static void runCommix(String url, RequestManager.Callback callback) {
        callback.onResult("[*] Command Injection Testi: Payloadlar deneniyor...");
    }
}